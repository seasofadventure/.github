<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="https://i.ibb.co/Qf33Jhq/ezgif-4-770d4f5fd8.png" type="image/png">
    <title>Seas Of Adventure</title>
</head>

<body>
    <header>
        <h1>Seas of Adventure</h1>
    </header>

    <nav>
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#movies">Movies</a></li>
            <li><a href="#games">Games</a></li>
        </ul>
    </nav>

    <section id="movies">
        <h2>Movies</h2>
        <div class="movie-grid" id="movie-grid">
        </div>
    </section>

    <section id="games">
        <h2>Games</h2>
        <div class="game-grid" id="game-grid">
        </div>
    </section>

    <script>
        // Define movie titles
        const movies = [
            "The Nightmare Before Christmas",
            "Five Nights at Freddy's",
            "Animal Farm",
            "Super Mario Bros Movie",
            "Pokemon Lucario and the Mystery Of Mew",
            "Pokemon The Movie 2000",
            "Pokemon Spell of Unown",
            "Pokemon 4ever Celebi",
            "Pokemon Heroes Latias and Latios",
            "Pokemon Jirachi Wish Maker",
            "Pokemon Destiny Deoxys",
            "Pokemon Ranger and the temple of the sea",
            "Pokemon The rise of Darkrai"
        ];

        // Define game titles
        const games = [
            "Hollow Knight",
            "Baba Is You"
        ];

        // Function to fetch movie covers using TMDb API
        async function fetchMovieCovers(movieTitle) {
            try {
                const apiKey = '225f2f562d49c4a8d484591f1ae3027c';
                const accessToken = 'eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyMjVmMmY5MjA3Yy';
                const response = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${apiKey}&query=${encodeURIComponent(movieTitle)}`, {
                    headers: {
                        'Authorization': `Bearer ${accessToken}`,
                    },
                });
                const data = await response.json();
                if (data.results && data.results.length > 0) {
                    const posterPath = data.results[0].poster_path;
                    if (posterPath) {
                        return `https://image.tmdb.org/t/p/w500${posterPath}`;
                    }
                }
            } catch (error) {
                console.error('Failed to fetch movie cover:', error);
            }
            return null;
        }

        // Function to fetch game covers from SteamGridDB
        async function fetchGameCovers(gameTitle) {
            const apiKey = '11ab5b9ee5df335261ec569e966d46bb';
            const response = await fetch(`https://www.steamgriddb.com/api/v2/grids/steam/${gameTitle}`, {
                headers: {
                    'Authorization': `Bearer ${apiKey}`
                }
            });
            const data = await response.json();
            if (data.data && data.data.length > 0) {
                const coverUrl = data.data[0].url;
                return coverUrl;
            }
            return null;
        }

        // Fetch movie covers using TMDb API and add them to the movie grid
        movies.forEach(async (movieTitle) => {
            let coverUrl = await fetchMovieCovers(movieTitle);

            if (coverUrl) {
                const movieGrid = document.getElementById("movie-grid");
                const movieDiv = document.createElement("div");
                movieDiv.classList.add("movie");
                movieDiv.innerHTML = `
                    <a href="movies/${movieTitle.replace(/ /g, '')}.html">
                        <img src="${coverUrl}" alt="${movieTitle}">
                        <h3>${movieTitle}</h3>
                    </a>
                `;
                movieGrid.appendChild(movieDiv);
            }
        });

        // Fetch game covers from SteamGridDB and add them to the game grid
        games.forEach(async (gameTitle) => {
            let coverUrl = await fetchGameCovers(gameTitle);

            if (coverUrl) {
                const gameGrid = document.getElementById("game-grid");
                const gameDiv = document.createElement("div");
                gameDiv.classList.add("game");
                gameDiv.innerHTML = `
                    <a href="games/${gameTitle.replace(/ /g, '')}.html">
                        <img src="${coverUrl}" alt="${gameTitle}">
                        <h3>${gameTitle}</h3>
                    </a>
                `;
                gameGrid.appendChild(gameDiv);
            }
        });

        // Check if the subpage is invalid and redirect to 404.html
        const path = window.location.pathname;
        const validSubpages = ["movies", "games"]; // Add your valid subpages here

        if (!validSubpages.some(subpage => path.startsWith("/" + subpage))) {
            window.location.href = "/404.html";
        }
    </script>
</body>
</html>
